/*! For license information please see main.461b39084bac624dd097.bundle.js.LICENSE.txt */
(function(){"use strict";var __webpack_modules__={436:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){function parseCell(str){var parsedStr=str;if(str.toString().startsWith("="))try{parsedStr=eval(str.slice(1))}catch(t){return parsedStr}return parsedStr}__webpack_require__.d(__webpack_exports__,{B:function(){return parseCell}})}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t](r,r.exports,__webpack_require__),r.exports}__webpack_require__.d=function(t,e){for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},function(){var t;__webpack_require__.g.importScripts&&(t=__webpack_require__.g.location+"");var e=__webpack_require__.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=t}();var __webpack_exports__={};!function(){var t="New Table",e={textAlign:"left",fontWeight:"normal",textDecoration:"none",fontStyle:"normal"},r={year:"numeric",month:"2-digit",day:"numeric"};function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.$el="string"==typeof e?document.querySelector(e):e}var r,o;return r=t,o=[{key:"data",get:function(){return this.$el.dataset}},{key:"height",get:function(){return this.$el.clientHeight}},{key:"width",get:function(){return this.$el.clientWidth}},{key:"html",value:function(t){return"string"==typeof t?(this.$el.innerHTML=t,this):this.$el.outerHTML.trim()}},{key:"getStyles",value:function(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return r.reduce((function(r,n){return r[n]=t.$el.style[n]?t.$el.style[n]:e[n],r}),{})}},{key:"text",value:function(t){return void 0!==t?("INPUT"===this.$el.tagName?this.$el.value=t:this.$el.textContent=t,this):"INPUT"===this.$el.tagName?this.$el.value.trim():this.$el.textContent.trim()}},{key:"clear",value:function(){return this.html(""),this}},{key:"attr",value:function(t,e){return e?(this.$el.setAttribute(t,e),this):this.$el.getAttribute(t)}},{key:"append",value:function(e){return e instanceof t&&(e=e.$el),Element.prototype.append?this.$el.append(e):this.$el.appendChild(e),this}},{key:"remove",value:function(t){return this.$el.removeChild(t),this}},{key:"cellId",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=this.$el.dataset.id.split(":");return t?"".concat(e[0],":").concat(e[1]):{row:+e[0],col:+e[1]}}},{key:"focus",value:function(){return this.$el.focus(),this}},{key:"on",value:function(t,e){this.$el.addEventListener(t,e)}},{key:"off",value:function(t,e){this.$el.removeEventListener(t,e)}},{key:"getMetrix",value:function(){return this.$el.getBoundingClientRect()}},{key:"findAll",value:function(t){return this.$el.querySelectorAll(t)}},{key:"find",value:function(t){return i(this.$el.querySelector(t))}},{key:"addClass",value:function(t){return this.$el.classList.add(t),this}},{key:"removeClass",value:function(t){return this.$el.classList.remove(t),this}},{key:"closest",value:function(t){return i(this.$el.closest(t))}},{key:"css",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(this.$el.style||{},t),this}}],o&&n(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),t}();function i(t){return new o(t)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}i.create=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",r=document.createElement(t);return e&&r.classList.add(e),i(r)};var a=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,r=[{key:"path",get:function(){return window.location.hash.slice(1)}},{key:"params",get:function(){return t.path.split("/")[1]}},{key:"navigate",value:function(t){window.location.hash=t}},{key:"base",get:function(){return"#"}}],null&&c(e.prototype,null),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var l=function(){function t(e,r){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),!e)throw new Error("Selector is not provided in Router");this.$placeholder=i(e),this.page=null,this.routes=r,this.changePageHandler=this.changePageHandler.bind(this),this.init()}var e,r;return e=t,r=[{key:"init",value:function(){window.addEventListener("hashchange",this.changePageHandler),this.changePageHandler()}},{key:"changePageHandler",value:function(){this.page&&this.page.destroy(),this.$placeholder.clear();var t=a.path.includes("excel")?"excel":"dashboard",e=this.routes[t];this.page=new e(a.params),this.$placeholder.append(this.page.getRoot()),this.page.afterRender()}},{key:"destroy",value:function(){window.removeEventListener("hashchange",this.changePageHandler)}}],r&&u(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var f=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.params=e}var e,r;return e=t,(r=[{key:"getRoot",value:function(){throw new Error('Method "getRoot" should be implemented')}},{key:"afterRender",value:function(){}},{key:"destroy",value:function(){}}])&&s(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function p(t){return p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},p(t)}function y(t,e){if(e<t){var r=[e,t];t=r[0],e=r[1]}return Array.from({length:e-t+1},(function(e,r){return t+r}))}function h(t,e){if(!e)return JSON.parse(localStorage.getItem(t));localStorage.setItem(t,JSON.stringify(e))}function b(t){return t.replace(/([A-Z])/g,(function(t){return"-".concat(t[0].toLowerCase())}))}function d(t){var e=h(t),n=t.split(":")[1];return'\n\t\t  <li class="db__record">\n        <a href="#excel/'.concat(n,'">').concat(e.title,'</a>\n        <strong><time datetime="').concat(n,'">').concat(new Date(+n).toLocaleString("ru-RU",r),"</time></strong>\n      </li>\n\t")}function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function m(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function w(t,e){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},w(t,e)}function O(t,e){if(e&&("object"===v(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _(t){return _=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e)}(a,t);var e,r,n,o,c=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=_(n);if(o){var r=_(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return O(this,t)});function a(){m(this,a);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return c.call.apply(c,[this].concat(e))}return e=a,(r=[{key:"getRoot",value:function(){var t,e=Date.now().toString();return i.create("div","db").html('\n\t\t\t<div class="db__header">\n\t      <h1>Excel Dashboard</h1>\n\t    </div>\n\t\n\t    <div class="db__new">\n\t      <div class="db__view">\n\t        <a href="#excel/'.concat(e,'" class="db__create">\n\t          New <br /> Table\n\t        </a>\n\t      </div>\n\t    </div>\n\t\n\t    <div class="db__table db__view">\n\t\t\t\t').concat((t=function(){for(var t=[],e=0;e<localStorage.length;e++){var r=localStorage.key(e);r.includes("excel")&&t.push(r)}return t}(),t.length?'\n\t\t<h3 class="db__table-title"> Your tables: </h3>\n\t  <div class="db__list-header">\n\t    <span>Name</span>\n\t    <span>Date</span>\n\t  </div>\n\t\t\n\t  <ul class="db__list">\n\t\t\t'.concat(t.map(d).join(""),"\n\t\t</ul>\n\t"):"<p> You don't have any tables created yet</p>"),"\n\t    </div>\n\t\t"))}}])&&g(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(f);function S(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var P=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.store=e,this.sub=function(){},this.prevState={}}var e,r;return e=t,(r=[{key:"subscribeComponents",value:function(t){var e=this;this.prevState=this.store.getState(),this.sub=this.store.subscribe((function(r){Object.keys(r).forEach((function(n){var o,i;o=e.prevState[n],i=r[n],("object"===p(o)&&"object"===p(i)?JSON.stringify(o)===JSON.stringify(i):o===i)||t.forEach((function(t){if(t.isWatching(n)){var e=function(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}({},n,r[n]);t.storeChanged(e)}}))})),e.prevState=e.store.getState()}))}},{key:"unsubscribeFromStore",value:function(){this.sub()}}])&&S(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var x=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.components=e.components||[],this.store=e.store,this.subscriber=new P(this.store)}var e,r;return e=t,(r=[{key:"getRoot",value:function(){var t=this,e=i.create("div","excel");return this.components=this.components.map((function(r){var n=i.create("div",r.className),o=new r(n,{store:t.store});return n.html(o.toHTML()),e.append(n),o})),e}},{key:"init",value:function(){this.subscriber.subscribeComponents(this.components),this.components.forEach((function(t){return t.init()}))}},{key:"destroy",value:function(){this.subscriber.unsubscribeFromStore(),this.components.forEach((function(t){return t.destroy()}))}}])&&k(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function E(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function T(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var R=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(E(this,t),!e)throw new Error("No $root provided for DOMListeners");this.$root=e,this.listeners=r,this.boundListeners=[]}var e,r;return e=t,r=[{key:"initListeners",value:function(){var t=this;this.listeners.forEach((function(e){var r="on"+function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.charAt(0).toUpperCase()+t.slice(1)}(e);if(!t[r])throw new Error("Method ".concat(r," is not implemented in ").concat(t.name," Component"));var n=t[r].bind(t);t.boundListeners.push({eventName:e,cb:n}),t.$root.on(e,n)}))}},{key:"removeListeners",value:function(){var t=this;this.boundListeners.forEach((function(e){var r=e.eventName,n=e.cb;return t.$root.off(r,n)}))}}],r&&T(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function $(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var C=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.listeners={}}var e,r;return e=t,r=[{key:"emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];Array.isArray(this.listeners[t])&&this.listeners[t].forEach((function(t){t.apply(void 0,r)}))}},{key:"subscribe",value:function(t,e){var r=this;return this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e),function(){r.listeners[t]=r.listeners[t].filter((function(t){return t!==e}))}}}],r&&$(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}(),L=new C;Object.freeze(L);var A=L;function D(t){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},D(t)}function N(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function B(t,e){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},B(t,e)}function H(t,e){if(e&&("object"===D(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function q(t){return q=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},q(t)}var G=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&B(t,e)}(c,t);var e,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=q(n);if(o){var r=q(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return H(this,t)});function c(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return N(this,c),(e=i.call(this,t,r.listeners)).name=r.name||"",e.store=r.store,e.subscribe=r.subscribe||[],e.unsubscribers=[],e.prepare(),e}return e=c,r=[{key:"prepare",value:function(){}},{key:"toHTML",value:function(){return""}},{key:"$emit",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];A.emit.apply(A,[t].concat(r))}},{key:"$on",value:function(t,e){this.unsubscribers.push(A.subscribe(t,e))}},{key:"$dispatch",value:function(t){this.store.dispatch(t)}},{key:"storeChanged",value:function(){}},{key:"isWatching",value:function(t){return this.subscribe.includes(t)}},{key:"init",value:function(){this.initListeners()}},{key:"destroy",value:function(){this.removeListeners(),this.unsubscribers.forEach((function(t){return t()}))}}],r&&I(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(R),M="TABLE_RESIZE",z="CHANGE_TEXT",F="APPLY_STYLE",U="CHANGE_CURRENT_STYLES",W="CHANGE_TITLE";function Y(t){return{type:M,data:t}}function J(t){return{type:U,data:t}}var K=__webpack_require__.p+"0357237bc841622f7e8a.svg";function X(t){return X="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},X(t)}function Z(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Q(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function V(t,e){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},V(t,e)}function tt(t,e){if(e&&("object"===X(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function et(t){return et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},et(t)}function rt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var nt=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&V(t,e)}(l,e);var r,n,o,c,u=(o=l,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=et(o);if(c){var r=et(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return tt(this,t)});function l(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),u.call(this,t,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Z(Object(r),!0).forEach((function(e){rt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Z(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({name:"Header",listeners:["input","click"]},e))}return r=l,(n=[{key:"onInput",value:function(t){var e;this.$dispatch((e={title:t.target.value},{type:W,data:e}))}},{key:"onClick",value:function(t){var e=i(t.target);"remove"===e.data.button?confirm("Do you really want to delete this excel table?")&&(localStorage.removeItem("excel:"+a.params),a.navigate("")):"exit"===e.data.button&&a.navigate("")}},{key:"toHTML",value:function(){return e=this.store.getState().title,'\n\t\t\t<div class="info">\n\t\t\t\t<a href="'.concat(a.base,'"><img src="').concat(K,'" alt="logo"></a>\n\t\t\t\t\n\t\t\t\t<input type="text" class="input" value="').concat(e||t,'" />\n\t\t\t</div>\n\n      <div>\n        <div class="button" data-button="remove">\n          <i class="material-icons" data-button="remove">delete</i>\n        </div>\n\n        <div class="button" data-button="exit">\n          <i class="material-icons" data-button="exit">exit_to_app</i>\n        </div>\n      </div>\n\t\t\n\t');var e}}])&&Q(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),l}(G);function ot(t){var e='data-type="button" data-value=\''.concat(JSON.stringify(t.value),"'");return'\n\t\t<div \n\t\t\tclass="button '.concat(t.active?"active":"",'"\n\t\t\t').concat(e,'\n\t\t>\n      <i \n        class="material-icons"\n        ').concat(e,"\n      >\n\t\t\t\t").concat(t.icon,"\n\t\t\t</i>\n    </div>\n\t")}function it(t){return it="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},it(t)}function ct(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function at(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ct(Object(r),!0).forEach((function(e){ut(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ct(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function ut(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function lt(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function st(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function ft(t,e){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ft(t,e)}function pt(t,e){if(e&&("object"===it(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function yt(t){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},yt(t)}rt(nt,"className","excel__header");var ht=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ft(t,e)}(c,t);var e,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=yt(n);if(o){var r=yt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return pt(this,t)});function c(){lt(this,c);for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];return i.call.apply(i,[this].concat(e))}return e=c,(r=[{key:"template",get:function(){return JSON.stringify(this.state,null,2)}},{key:"initialState",value:function(t){this.state=at({},t)}},{key:"setState",value:function(t){this.state=at(at({},this.state),t),this.$root.html(this.template)}}])&&st(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(G);function bt(t){return bt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bt(t)}function dt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function vt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function mt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?vt(Object(r),!0).forEach((function(e){Pt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):vt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function gt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function wt(){return wt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Ot(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},wt.apply(this,arguments)}function Ot(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=St(t)););return t}function _t(t,e){return _t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_t(t,e)}function jt(t,e){if(e&&("object"===bt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function St(t){return St=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},St(t)}function Pt(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var kt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_t(t,e)}(u,t);var r,n,o,c,a=(o=u,c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=St(o);if(c){var r=St(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return jt(this,t)});function u(t,r){var n;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),(n=a.call(this,t,{name:"Toolbar",listeners:["click"],subscribe:["currentStyles"]})).defaultStyles=mt(mt({},e),r.store.getState().currentStyles),n}return r=u,(n=[{key:"template",get:function(){return[{icon:"format_align_left",active:"left"===(t=this.state).textAlign,value:{textAlign:"left"}},{icon:"format_align_center",active:"center"===t.textAlign,value:{textAlign:"center"}},{icon:"format_align_right",active:"right"===t.textAlign,value:{textAlign:"right"}},{icon:"format_bold",active:"bold"===t.fontWeight,value:{fontWeight:"bold"===t.fontWeight?"normal":"bold"}},{icon:"format_italic",active:"italic"===t.fontStyle,value:{fontStyle:"italic"===t.fontStyle?"normal":"italic"}},{icon:"format_underline",active:"underline"===t.textDecoration,value:{textDecoration:"underline"===t.textDecoration?"none":"underline"}}].map(ot).join("");var t}},{key:"prepare",value:function(){this.initialState(e)}},{key:"init",value:function(){wt(St(u.prototype),"init",this).call(this),this.setState(this.defaultStyles)}},{key:"onClick",value:function(t){var e,r,n=i(t.target).data;if("button"===n.type){var o=(e=Object.entries(JSON.parse(n.value))[0],r=2,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i=[],c=!0,a=!1;try{for(r=r.call(t);!(c=(n=r.next()).done)&&(i.push(n.value),!e||i.length!==e);c=!0);}catch(t){a=!0,o=t}finally{try{c||null==r.return||r.return()}finally{if(a)throw o}}return i}}(e,r)||function(t,e){if(t){if("string"==typeof t)return dt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?dt(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=o[0],a=o[1];this.$emit("toolbar:applyStyle",Pt({},c,a))}}},{key:"storeChanged",value:function(t){var e=t.currentStyles;this.setState(e)}},{key:"toHTML",value:function(){return this.template}}])&&gt(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),u}(ht);function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function Et(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function Tt(){return Tt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=Rt(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Tt.apply(this,arguments)}function Rt(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Lt(t)););return t}function $t(t,e){return $t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},$t(t,e)}function Ct(t,e){if(e&&("object"===xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function Lt(t){return Lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Lt(t)}Pt(kt,"className","excel__toolbar");var At,Dt,Nt,It=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&$t(t,e)}(a,t);var e,r,n,o,c=(n=a,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Lt(n);if(o){var r=Lt(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return Ct(this,t)});function a(t,e){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),c.call(this,t,{name:"Formula",listeners:["input","keydown"],subscribe:["currentText"],store:e.store})}return e=a,(r=[{key:"init",value:function(){Tt(Lt(a.prototype),"init",this).call(this);var t=this.$root.find('[data-id="formula"]');this.$on("table:select",(function(e){return t.text(e)}))}},{key:"storeChanged",value:function(t){var e=t.currentText;this.$root.find('[data-id="formula"]').text(e)}},{key:"onInput",value:function(t){this.$emit("formula:input",i(t.target).text())}},{key:"onKeydown",value:function(t){["Tab","Enter"].includes(t.key)&&(t.preventDefault(),this.$emit("formula:done"))}},{key:"toHTML",value:function(){return'\n      <div class="info">fx</div>\n      <div class="input" contenteditable spellcheck="false" data-id="formula"></div>\n\t\t'}}])&&Et(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),a}(G);Nt="excel__formula",(Dt="className")in(At=It)?Object.defineProperty(At,Dt,{value:Nt,enumerable:!0,configurable:!0,writable:!0}):At[Dt]=Nt;var Bt=__webpack_require__(436),Ht={col:120,row:20};function qt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"col",n=r+"State";return(t[n][e]||Ht[r])+"px"}function Gt(t,e){return String.fromCharCode(65+e)}function Mt(t,e,r){return'\n\t\t<div\n\t\t\tclass="cell" \n\t\t\tcontenteditable \n\t\t\tdata-col="'.concat(e,'" \n\t\t\tdata-id="').concat(t,":").concat(e,'" \n\t\t\tstyle="').concat(function(t,e,r){var n="",o=r.stylesState["".concat(t,":").concat(e)];return o&&(n=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map((function(e){return"".concat(b(e),": ").concat(t[e])})).join(";")}(o)+";"),n}(t,e,r)," width: ").concat(qt(r,e),'"\n\t\t\t>').concat(function(t,e,r){return(0,Bt.B)(r.dataState["".concat(t,":").concat(e)]||"")}(t,e,r),"</div>\n\t")}function zt(t,e,r){return'\n\t\t<div \n\t\t\tclass="column" \n\t\t\tdata-type="resizable" \n\t\t\tdata-col="'.concat(e,'" \n\t\t\tstyle="width: ').concat(qt(r,e),'"\n\t\t\t>\n\t\t\t\t').concat(t,'\n\t\t\t\t<i class="col-resize" data-resize="col"></i>\n\t\t</div>\n\t')}function Ft(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0;return'\n\t\t<div class="row" \n\t\t\tdata-type="resizable" \n\t\t\tdata-row="'.concat(e,'"\n\t\t\t').concat(r&&'style="height: '.concat(qt(r,e,"row"),'"'),'\n\t\t>\n\t\t\t<div class="row-info">').concat(e||""," ").concat(e&&'<i class="row-resize" data-resize="row"></i>','</div>\n\t\t\t<div class="row-data">').concat(t,"</div>\n\t\t</div>\n\t")}function Ut(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=i.create("i","decorate-line");r?n.css({height:e.height+"px"}):n.css({width:e.width+"px"}),t.append(n)}function Wt(t,e){return new Promise((function(r){var n=!0,o=i(t.target),c=o.data.resize,a=o.closest('[data-type="resizable"]'),u=a.getMetrix(),l=0;a.addClass("is-drag"),"col"===c?(Ut(o,e),document.onmousemove=function(t){n=!1;var e=t.pageX-u.right;(l=u.width+e+2)>=40?o.css({right:-e+"px"}):l=40}):(Ut(o,e,!1),document.onmousemove=function(t){n=!1;var e=t.pageY-u.bottom+scrollY;(l=u.height+e+2)>=20?o.css({bottom:-e+"px"}):l=20}),document.onmouseup=function(t){var i;document.onmousemove=null,document.onmouseup=null,(i=o).remove(i.find(".decorate-line").$el),a.removeClass("is-drag"),n||("col"===c?(a.css({width:l+"px"}),e.findAll('[data-col="'.concat(a.data.col,'"]')).forEach((function(t){return t.style.width=l+"px"})),o.css({right:0})):(a.css({height:l+"px"}),o.css({bottom:0})),r({val:l,id:a.data[c],type:c}))}}))}function Yt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var Jt=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.group=[],this.current=null,this.firstSelected=null,this.selectedCellsEl=null}var e,r;return e=t,r=[{key:"selectedIds",get:function(){return this.group.map((function(t){return t.cellId(!0)}))}},{key:"setSelectedElement",value:function(){this.selectedCellsEl=i(document.querySelector("[data-select-cell]"))}},{key:"setFirstSelected",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.firstSelected=t}},{key:"select",value:function(e){this.clear(),this.setFirstSelected(),this.group.push(e),this.current=e,e.focus().addClass(t.activeClassName),this.addDecorationToSelect()}},{key:"clear",value:function(){this.group.forEach((function(e){return e.removeClass(t.activeClassName)})),this.group=[]}},{key:"selectGroup",value:function(e,r){r&&(this.current=r,r.focus()),this.clear(),this.group=e,this.group.forEach((function(e){return e.addClass(t.activeClassName)})),this.addDecorationToSelect()}},{key:"applyStyle",value:function(t){this.group.forEach((function(e){return e.css(t)}))}},{key:"addDecorationToSelect",value:function(){var t=this.group[0],e=this.group[this.group.length-1],r=t.$el.offsetLeft,n=t.$el.offsetTop,o=e.$el.offsetLeft+e.$el.offsetWidth-r,i=e.$el.offsetTop+e.$el.offsetHeight-n;this.selectedCellsEl.css({left:r+"px",top:n+"px",width:o+"px",height:i+"px"})}}],r&&Yt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Kt(t,e){var r=t.cellId(),n=e.cellId(),o=y(n.col,r.col),i=y(n.row,r.row);return o.reduce((function(t,e){return i.forEach((function(r){return t.push('[data-id="'.concat(r,":").concat(e,'"]'))})),t}),[]).join(",")}function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function Zt(t){return function(t){if(Array.isArray(t))return Qt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Qt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Qt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Vt(){Vt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var o=e&&e.prototype instanceof f?e:f,i=Object.create(o.prototype),c=new j(n||[]);return i._invoke=function(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var c=r.delegate;if(c){var a=w(c,r);if(a){if(a===s)continue;return a}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=l(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===s)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,c),i}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var s={};function f(){}function p(){}function y(){}var h={};a(h,o,(function(){return this}));var b=Object.getPrototypeOf,d=b&&b(b(S([])));d&&d!==e&&r.call(d,o)&&(h=d);var v=y.prototype=f.prototype=Object.create(h);function m(t){["next","throw","return"].forEach((function(e){a(t,e,(function(t){return this._invoke(e,t)}))}))}function g(t,e){function n(o,i,c,a){var u=l(t[o],t,i);if("throw"!==u.type){var s=u.arg,f=s.value;return f&&"object"==Xt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,c,a)}),(function(t){n("throw",t,c,a)})):e.resolve(f).then((function(t){s.value=t,c(s)}),(function(t){return n("throw",t,c,a)}))}a(u.arg)}var o;this._invoke=function(t,r){function i(){return new e((function(e,o){n(t,r,e,o)}))}return o=o?o.then(i,i):i()}}function w(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,w(t,e),"throw"===e.method))return s;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return s}var n=l(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,s;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,s):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,s)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function S(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,i=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return i.next=i}}return{next:P}}function P(){return{value:void 0,done:!0}}return p.prototype=y,a(v,"constructor",y),a(y,"constructor",p),p.displayName=a(y,c,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,a(t,c,"GeneratorFunction")),t.prototype=Object.create(v),t},t.awrap=function(t){return{__await:t}},m(g.prototype),a(g.prototype,i,(function(){return this})),t.AsyncIterator=g,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var c=new g(u(e,r,n,o),i);return t.isGeneratorFunction(r)?c:c.next().then((function(t){return t.done?t.value:c.next()}))},m(v),a(v,c,"Generator"),a(v,o,(function(){return this})),a(v,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=S,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(_),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return c.type="throw",c.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],c=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var a=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(a&&u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var c=i?i.completion:{};return c.type=t,c.arg=e,i?(this.method="next",this.next=i.finallyLoc,s):this.complete(c)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),s},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),s}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:S(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),s}},t}function te(t,e,r,n,o,i,c){try{var a=t[i](c),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,o)}function ee(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function re(){return re="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=ne(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},re.apply(this,arguments)}function ne(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=ce(t)););return t}function oe(t,e){return oe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},oe(t,e)}function ie(t,e){if(e&&("object"===Xt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function ce(t){return ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ce(t)}!function(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(Jt,"activeClassName","selected");var ae=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&oe(t,e)}(s,t);var r,n,o,c,a,u,l=(a=s,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=ce(a);if(u){var r=ce(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ie(this,t)});function s(t,e){var r;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,s),(r=l.call(this,t,{name:"Table",listeners:["mousedown","keydown","input"],store:e.store})).rowsCount=15,r.colsCount=26,r}return r=s,n=[{key:"prepare",value:function(){this.selections=new Jt}},{key:"init",value:function(){var t=this;re(ce(s.prototype),"init",this).call(this),this.selections.setSelectedElement();var e=this.$root.find('[data-id="0:0"]');this.selectCell(e),this.$on("formula:input",(function(e){t.updateTextInStore(e)})),this.$on("formula:done",(function(e){return t.selections.current.focus()})),this.$on("toolbar:applyStyle",(function(e){var r;t.selections.applyStyle(e),t.$dispatch(J(e)),t.$dispatch((r={value:e,ids:t.selections.selectedIds},{type:F,data:r}))}))}},{key:"onKeydown",value:function(t){if(["Enter","Tab","ArrowUp","ArrowRight","ArrowDown","ArrowLeft"].includes(t.key)){t.preventDefault(),t.shiftKey&&!this.selections.firstSelected&&this.selections.setFirstSelected(this.selections.current);var e=function(t,e){var r=e.row,n=e.col;switch(t){case"Enter":case"ArrowDown":r++;break;case"Tab":case"ArrowRight":n++;break;case"ArrowUp":r--;break;case"ArrowLeft":n--}return{row:r,col:n}}(t.key,this.selections.current.cellId()),r=e.row,n=e.col;if(r>=0&&r<this.rowsCount&&n>=0&&n<this.colsCount){var o='[data-id="'.concat(r,":").concat(n,'"]'),i=this.$root.find(o);t.shiftKey?this.selectGroup(i,this.selections.firstSelected):this.selectCell(i)}}}},{key:"resizeTable",value:(o=Vt().mark((function t(e){var r;return Vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Wt(e,this.$root);case 3:r=t.sent,this.selections.addDecorationToSelect(),this.$dispatch(Y(r)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Resize error",t.t0);case 11:case"end":return t.stop()}}),t,this,[[0,8]])})),c=function(){var t=this,e=arguments;return new Promise((function(r,n){var i=o.apply(t,e);function c(t){te(i,r,n,c,a,"next",t)}function a(t){te(i,r,n,c,a,"throw",t)}c(void 0)}))},function(t){return c.apply(this,arguments)})},{key:"onMousedown",value:function(t){if(function(t){return t.target.dataset.resize}(t)&&this.resizeTable(t),function(t){return t.target.dataset.id}(t)){var e=i(t.target);t.shiftKey?this.selectGroup(e):this.selectCell(e)}}},{key:"onInput",value:function(t){this.updateTextInStore(i(t.target).text())}},{key:"selectGroup",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.selections.current,r=Zt(this.$root.findAll(Kt(e,t))).map((function(t){return i(t)}));this.selections.selectGroup(r,t)}},{key:"selectCell",value:function(t){this.selections.current&&this.selections.current.text((0,Bt.B)(this.selections.current.text())),this.selections.select(t);var r=this.store.getState().dataState[t.cellId(!0)]||"";this.$emit("table:select",r),this.selections.current.text(r);var n=t.getStyles(Object.keys(e));this.$dispatch(J(n))}},{key:"updateTextInStore",value:function(t){var e;this.selections.current.text(t),this.$dispatch((e={text:t,id:this.selections.current.cellId(!0)},{type:z,data:e}))}},{key:"toHTML",value:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:15,e=arguments.length>1?arguments[1]:void 0,r=26,n=new Array(r).fill("").map(Gt).map((function(t,r){return zt(t,r,e)})).join(""),o=[];o.push(Ft(n));for(var i=0;i<t;i++){var c=new Array(r).fill(i).map((function(t,r){return Mt(t,r,e)})).join("");o.push(Ft(c,i+1,e))}return o.push('<i class="selected-cells" data-select-cell></i>'),o.join("")}(this.rowsCount,this.store.getState())}}],n&&ee(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),s}(G);function ue(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function le(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function se(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function fe(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?se(Object(r),!0).forEach((function(e){pe(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):se(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function pe(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function ye(t,e){var r=null;switch(e.type){case W:return fe(fe({},t),{},{title:e.data.title});case M:var n="col"===e.data.type?"colState":"rowState";return(r=fe({},t[n])||{})[e.data.id]=e.data.val,fe(fe({},t),{},pe({},n,r));case z:return(r=fe({},t.dataState)||{})[e.data.id]=e.data.text,fe(fe({},t),{},{currentText:e.data.text,dataState:r});case U:return fe(fe({},t),{},{currentStyles:e.data});case F:var o=t.stylesState||{};return e.data.ids.forEach((function(t){o[t]=fe(fe({},o[t]),e.data.value)})),fe(fe({},t),{},{stylesState:o});default:return t}}!function(t,e,r){e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}(ae,"className","excel__table");var he={title:t,colState:{},rowState:{},dataState:{},currentText:"",currentStyles:e,stylesState:{}};function be(t){return be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},be(t)}function de(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ve(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function me(t,e){return me=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},me(t,e)}function ge(t,e){if(e&&("object"===be(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function we(t){return we=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},we(t)}function Oe(t){return"excel:".concat(t)}var _e=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&me(t,e)}(c,t);var e,r,n,o,i=(n=c,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=we(n);if(o){var r=we(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return ge(this,t)});function c(){return de(this,c),i.apply(this,arguments)}return e=c,r=[{key:"getRoot",value:function(){var t,e,r=this,n=function(t,e){var r=t(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?ue(Object(r),!0).forEach((function(e){le(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):ue(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}({},e),{type:"__INIT__"}),n=[];return{subscribe:function(t){return n.push(t),function(){n.filter((function(e){return e!==t}))}},dispatch:function(e){r=t(r,e),n.forEach((function(t){t(r)}))},getState:function(){return r}}}(ye,h(Oe(this.params))||he),o=(t=function(t){h(Oe(r.params),t)},300,e=null,function(){for(var r=this,n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];var c=function(){clearTimeout(e),t.apply(r,o)};clearTimeout(e),e=setTimeout(c,300)});return n.subscribe(o),this.excel=new x({components:[nt,kt,It,ae],store:n}),this.excel.getRoot()}},{key:"afterRender",value:function(){this.excel.init()}},{key:"destroy",value:function(){this.excel.destroy()}}],r&&ve(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),c}(f);new l("#app",{dashboard:j,excel:_e})}()})();